# ======================================
# DATASOURCE POSTGRESQL
# ======================================
quarkus.datasource.db-kind=postgresql
quarkus.datasource.username=postgres
quarkus.datasource.password=masterkey
quarkus.datasource.jdbc.url=jdbc:postgresql://localhost:5432/biblioteca_virtual

# ======================================
# HIBERNATE
# ======================================
quarkus.hibernate-orm.database.generation=drop-and-create
quarkus.hibernate-orm.log.sql=true
quarkus.hibernate-orm.sql-load-script=import.sql

# ======================================
# JAKARTA FACES
# ======================================
quarkus.faces.welcome-files=index.xhtml

# ======================================
# HTTP
# ======================================
quarkus.http.port=8080
quarkus.http.cors=true
quarkus.http.cors.origins=*
quarkus.http.auth.proactive=false

# ======================================
# CONSOLE & LOG
# ======================================
quarkus.console.enabled=false
quarkus.log.console.enable=true
quarkus.dev-ui.always-include=true

# ======================================
# SEGURANÇA - LOGIN POR FORMULÁRIO (Seu código, está correto)
# ======================================
quarkus.http.auth.form.enabled=true
quarkus.http.auth.form.login-page=/login.xhtml
quarkus.http.auth.form.error-page=/login.xhtml?error=true
quarkus.http.auth.form.landing-page=/index.xhtml
quarkus.http.auth.form.post-location=/j_security_check

# ======================================
# SEGURANÇA - PROVEDOR DE IDENTIDADE (ADIÇÃO CRÍTICA)
# ======================================
# 1. Habilita a extensão de segurança JPA
quarkus.security.jpa.enabled=true
quarkus.security.users.embedded.enabled=false

# 2. Informa qual é a sua entidade de usuário (AJUSTE O PACOTE SE NECESSÁRIO)
quarkus.security.jpa.user-entity-name=br.upf.entity.Usuarios

# 3. Informa quais campos (propriedades) da entidade usar
quarkus.security.jpa.identity-provider.username-property=username
quarkus.security.jpa.identity-provider.password-property=password
quarkus.security.jpa.identity-provider.role-property=roles

# 4. Informa o tipo de senha (ESSENCIAL para o seu import.sql)
# Isso diz ao Quarkus para usar BCRYPT ao comparar a senha
quarkus.security.jpa.identity-provider.password-type=bcrypt

# ======================================
# SEGURANÇA - POLÍTICAS DE ACESSO (ADIÇÃO CRÍTICA)
# ======================================
# (Substitui sua linha 'quarkus.http.auth.policy.deny-unauthenticated.enabled=false')

# 1. Define as páginas públicas (login e recursos do JSF, como CSS/JS)
quarkus.http.auth.permission.public.paths=/login.xhtml, /j_security_check, /jakarta.faces.resource/*
quarkus.http.auth.permission.public.policy=permit

# 2. Define que todo o resto do site (/*) exige autenticação
quarkus.http.auth.permission.private.paths=/*
quarkus.http.auth.permission.private.policy=authenticated